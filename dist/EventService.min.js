define([],function(){"use strict";var t=0,e={defaultChannel:{}},i=function(t,i,n){var o=e[t]||e.defaultChannel,r=o[i];r.length>0&&r.splice(r.indexOf(n),1)},n=function(t,e){return t.priority<e.priority?-1:t.priority===e.priority?0:1},o=function(t,e,i){i.enumerable=i.enumerable||!1,i.configurable=i.configurable||!1,i.value=e,Object.defineProperty(this,t,i)},r=function(t,e){o.call(this,t,e,{writable:!1})},c=function(t,e){o.call(this,t,e,{writable:!0})},a=function(t,e,i,n){if(void 0===t&&n!==!0)return t;if(typeof t!==e)throw new TypeError("Invalid type"+(void 0!==i?" for "+i:""));return t},l=function(t,i){var o=e[t]||e.defaultChannel;void 0!==o[i]&&0!==o[i].length&&o[i].sort(n)},s=function(t){r.call(this,"evtId",t.evtId),r.call(this,"callBack",t.callBack),r.call(this,"channel",t.channel),r.call(this,"evtName",t.evtName),r.call(this,"context",t.context),c.call(this,"priority",t.priority||0)};s.prototype={incrementPriority:function(t){this._checkIfStopped(),this.priority+=a(t,"number","step")||1,l(this.channel,this.evtName)},decrementPriority:function(t){this._checkIfStopped(),this.priority-=a(t,"number","step")||1,l(this.channel,this.evtName)},trigger:function(t){this._checkIfStopped(),this.isPaused()||this.callBack.apply(this.context,t)},isPaused:function(){return this.paused===!0},pause:function(){this._checkIfStopped(),c.call(this,"paused",!0)},resume:function(){this._checkIfStopped(),c.call(this,"paused",!1)},stop:function(){r.call(this,"stopped",!0),i(this.channel,this.evtName,this)},isStopped:function(){return this.stopped===!0},_checkIfStopped:function(){if(this.isStopped())throw new Error("Stopped event")}};var h=function(){};return h.prototype={on:function(i,o){var r=t++,c=a(i.channel,"string","channel"),l=a(i.priority,"number","priority"),h=a(i.evtName,"string","evtName",!0),f=a(i.callBack,"function","callBack",!0),u=e.defaultChannel,p=new s({evtId:r,evtName:h,channel:c,priority:l,callBack:f,context:o||this});return void 0!==c&&(void 0===e[c]&&(e[c]={}),u=e[c]),void 0===u[h]&&(u[h]=[]),u[h].push(p),u[h].sort(n),p},off:function(t){if(t instanceof s)t.stop();else if("object"==typeof t){var i=a(t.channel,"string","channel")||"defaultChannel",n=a(t.evtName,"string","evtName"),o=a(t.prioritySelector,"function","prioritySelector"),r=void 0!==i?e[i]:e.defaultChannel;if(void 0===r)return!1;var c=function(t){void 0!==t&&0!==t.length&&(void 0===o?t.slice().forEach(function(t){t.stop()}):t.slice().forEach(function(t){o.call(this,t.priority)&&t.stop()}))};void 0!==n?c(r[n]):Object.keys(r).forEach(function(t){c(r[t])})}},trigger:function(t,i){var o,r,c;"object"==typeof t?(o=a(t.evtName,"string","evtName"),r=a(t.channel,"string","channel"),c=a(t.prioritySelector,"function","prioritySelector")):o=a(t,"string","evtName",!0);var l,s=void 0!==r?e[r]:e.defaultChannel,h=void 0!==s?Object.keys(s):[];void 0!==o?l=void 0!==s[o]?s[o]:[]:(l=[],h.forEach(function(t){s[t].length>0&&(l=l.concat(s[t]))})),l.length>0&&(void 0!==c&&(l=l.filter(function(t){return c.call(this,t.priority)})),l.sort(n),i=Array.prototype.slice.call(arguments,1),l.forEach(function(t){t.trigger(i)}))}},h});